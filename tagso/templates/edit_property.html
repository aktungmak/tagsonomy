{% extends "base.html" %}

{% block title %}Tagsonomy | Edit Property{% endblock %}

{% block scripts %}
<script>
    function addAltLabelField() {
        const container = document.getElementById('alt_labels_container');
        const newField = document.createElement('div');
        newField.className = 'alt-label-field';

        const input = document.createElement('input');
        input.type = 'text';
        input.name = 'alt_labels';
        input.placeholder = 'Alternative label';
        input.required = true;

        const removeBtn = document.createElement('button');
        removeBtn.type = 'button';
        removeBtn.textContent = 'Remove';
        removeBtn.onclick = function() { removeAltLabelField(this); };

        newField.appendChild(input);
        newField.appendChild(removeBtn);
        container.appendChild(newField);
    }

    function removeAltLabelField(button) {
        button.parentElement.remove();
    }
</script>
{% endblock %}

{% block content %}
<h1>Edit Property</h1>
<section>
    <form action="{{ url_for('properties.property_edit_post') }}" method="post">
        <input type="hidden" name="uri" value="{{ property.uri }}"/>
        
        <p><b>URI:</b> {{ property.uri }}</p>
        
        <label for="label">Label:</label>
        <input type="text" name="label" id="label" value="{{ property.label or '' }}" required/>
        
        <label for="comment">Comment:</label>
        <textarea name="comment" id="comment" rows="3">{{ property.comment or '' }}</textarea>
        
        <label for="domain">Domain:</label>
        <select name="domain" id="domain">
            <option value="">— None —</option>
            {% for concept in concepts %}
            <option value="{{ concept.uri }}" {% if property.domain == concept.uri %}selected{% endif %}>{{ concept.label or concept.uri }}</option>
            {% endfor %}
        </select>
        
        <label for="range">Range:</label>
        <select name="range" id="range">
            <option value="">— None —</option>
            {% for concept in concepts %}
            <option value="{{ concept.uri }}" {% if property.range == concept.uri %}selected{% endif %}>{{ concept.label or concept.uri }}</option>
            {% endfor %}
        </select>
        
        <label>Alternative Labels:</label>
        <div id="alt_labels_container">
            {% for alt_label in property.alt_labels or [] %}
            <div class="alt-label-field">
                <input type="text" name="alt_labels" value="{{ alt_label }}" placeholder="Alternative label" required/>
                <button type="button" onclick="removeAltLabelField(this)">Remove</button>
            </div>
            {% endfor %}
        </div>
        <button type="button" onclick="addAltLabelField()">Add Alternative Label</button>
        
        <input type="submit" value="Save Changes"/>
    </form>
</section>

<hr/>

<a href="{{ url_for('properties.properties_get', property_uri=property.uri) }}"><button type="button">Back to Properties</button></a>
{% endblock %}

